let d=()=>{let l=document.getElementById("article-content");if(!l)return;const e=l.getBoundingClientRect(),s=e.height,t=e.y-100;if(t*-1>=s?(document.getElementById("progress-bar")?.style.setProperty("--scrollAmount","100%"),document.getElementById("progress-bar")?.classList.add("hidden"),document.getElementById("progress-bar")?.classList.remove("sticky")):(document.getElementById("progress-bar")?.classList.remove("hidden"),document.getElementById("progress-bar")?.classList.add("sticky")),t<0&&t*-1<=s){let o=t*-1/s*100+"%";document.getElementById("progress-bar")?.style.setProperty("--scrollAmount",o)}else t>=0&&document.getElementById("progress-bar")?.style.setProperty("--scrollAmount","0%")};document.addEventListener("scroll",d);const i=sessionStorage.getItem("liked");class a extends HTMLElement{liked=i!==null;hearth=this.querySelector("#hearth-icon");hearthFull=this.querySelector("#hearth-full-icon");constructor(){super();const e=this.dataset.id;e&&(i?(this.hearth?.classList.add("hidden"),this.hearthFull?.classList.add("block")):(this.hearth?.classList.add("block"),this.hearthFull?.classList.add("hidden")),this.querySelector("button")?.addEventListener("click",()=>{this.querySelector("button")?.setAttribute("disabled","true"),this.toggleStorage(),this.hearth?.classList.toggle("block"),this.hearth?.classList.toggle("hidden"),this.hearthFull?.classList.toggle("hidden"),this.hearthFull?.classList.toggle("block"),this.liked?this.addLike(+e):this.removeLike(+e)}))}async addLike(e){const s=await fetch(`/api/articles/${e}/likes/add.json`).then(t=>t.json()).then(t=>t);this.querySelector("span").textContent=s.likes,this.querySelector("button")?.removeAttribute("disabled")}async removeLike(e){const s=await fetch(`/api/articles/${e}/likes/remove.json`).then(t=>t.json()).then(t=>t);this.querySelector("span").textContent=s.likes,this.querySelector("button")?.removeAttribute("disabled")}toggleStorage=()=>{this.liked=!this.liked,this.liked?sessionStorage.setItem("liked","true"):sessionStorage.removeItem("liked")}}class n extends HTMLElement{shared=!1;icon=this.querySelector("#share-icon");iconFull=this.querySelector("#share-full-icon");modal=this.querySelector("#share-modal-content");modalbg=document.querySelector("#modal-background");menu=document.querySelector("#menu");constructor(){super(),this.dataset.id&&(this.icon?.classList.add("block"),this.iconFull?.classList.add("hidden"),this.shared=!1,this.querySelector("button")?.addEventListener("click",()=>{this.shared?this.closeModal():this.openModal()}))}closeModal=()=>{this.modal?.classList.add("hidden"),this.modal?.classList.remove("flex"),this.icon?.classList.remove("hidden"),this.icon?.classList.add("block"),this.iconFull?.classList.remove("block"),this.iconFull?.classList.add("hidden"),this.modalbg?.classList.remove("block"),this.modalbg?.classList.add("hidden"),this.modalbg?.removeEventListener("click",this.closeModal,!0),this.menu?.removeEventListener("click",this.closeModal,!0),this.shared=!1,this.modal?.querySelector("button")?.classList.remove("text-green-500")};openModal=()=>{this.modal?.classList.remove("hidden"),this.modal?.classList.add("flex"),this.icon?.classList.remove("block"),this.icon?.classList.add("hidden"),this.iconFull?.classList.remove("hidden"),this.iconFull?.classList.add("block"),this.modalbg?.classList.remove("hidden"),this.modalbg?.classList.add("block"),this.menu?.addEventListener("click",this.closeModal,!0),this.modalbg?.addEventListener("click",this.closeModal,!0),this.shared=!0}}class r extends HTMLElement{modal=this.querySelector("#menu-modal-content");modalbg=document.querySelector("#modal-background");constructor(){super(),this.dataset.id&&(console.log(this.modalbg),this.querySelector("button")?.addEventListener("click",()=>{this.modal?.getAttribute("data-active")!=="true"?this.openModal():this.closeModal()}))}closeModal=()=>{this.modal?.removeAttribute("data-active"),this.modalbg?.removeAttribute("data-active"),this.modalbg?.removeEventListener("click",this.closeModal,!0)};openModal=()=>{this.modal?.setAttribute("data-active","true"),this.modalbg?.setAttribute("data-active","true"),this.modalbg?.addEventListener("click",this.closeModal,!0)}}customElements.define("menu-button",r);customElements.define("like-button",a);customElements.define("share-button",n);class c extends HTMLElement{addUsefullCount=document.getElementById("add-usefull-count");addUselessCount=document.getElementById("add-useless-count");constructor(){super();const e=this.dataset.id;if(!e)return;const s=sessionStorage.getItem("feedback");s==="usefull"?(this.addUsefullCount?.setAttribute("disabled","true"),this.addUsefullCount?.setAttribute("data-active","true")):s==="useless"&&(this.addUselessCount?.setAttribute("disabled","true"),this.addUselessCount?.setAttribute("data-active","true")),this.addUsefullCount?.addEventListener("click",()=>{this.addUsefullCount?.setAttribute("disabled","true"),this.addUselessCount?.setAttribute("disabled","true"),this.setUsefull(+e),this.setSessionStorage("usefull")}),this.addUselessCount?.addEventListener("click",()=>{this.addUsefullCount?.setAttribute("disabled","true"),this.addUselessCount?.setAttribute("disabled","true"),this.setUseless(+e),this.setSessionStorage("useless")})}async setUsefull(e){const s=await fetch(`/api/articles/${e}/add-usefull.json`).then(t=>t.json()).then(t=>t);this.querySelector("#usefull-count").textContent=s.usefullCount,this.addUselessCount?.removeAttribute("disabled"),this.addUsefullCount?.setAttribute("data-active","true"),this.addUselessCount?.removeAttribute("data-active")}async setUseless(e){const s=await fetch(`/api/articles/${e}/add-useless.json`).then(t=>t.json()).then(t=>t);this.querySelector("#usefull-count").textContent=s.usefullCount,this.addUsefullCount?.removeAttribute("disabled"),this.addUselessCount?.setAttribute("data-active","true"),this.addUsefullCount?.removeAttribute("data-active")}setSessionStorage(e){sessionStorage.setItem("feedback",e)}}customElements.define("feedback-component",c);class u extends HTMLElement{constructor(){super(),this.querySelector("button")?.addEventListener("click",e=>{e.stopPropagation(),navigator.clipboard.writeText(this.querySelector("span")?.textContent||""),e.target.classList.add("text-green-500")})}}customElements.define("modal-component",u);const h=document.querySelectorAll("#menu-modal-content a");h.forEach(l=>{l.addEventListener("click",e=>{e.preventDefault();const s=e.target?.getAttribute("id").replace("link-to-","");document.getElementById(s)?.scrollIntoView({behavior:"smooth",block:"center"}),document.querySelector("#modal-background")?.removeAttribute("data-active"),document.querySelector("#menu-modal-content")?.removeAttribute("data-active")})});
